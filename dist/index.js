var g=Object.defineProperty;var a=(e,t)=>g(e,"name",{value:t,configurable:!0});var y=["number","string","bigint","boolean","symbol","object"],p=0,f=-1,v={empty:Symbol("empty")},s=a(e=>y.includes(e),"isTypeAllowed"),c=a(e=>{var t=typeof e,n=t==="object"&&e!==null;return n||s(t)},"isValueTypeAllowed"),l=a((e,t)=>c(e)&&typeof e===t,"canCommit"),d=a(e=>e===void 0,"isItemEmpty"),u=a((e,t)=>e%t,"makeIndex"),r=new WeakMap;function i(e,t){if(typeof e!="number"||e<=0||!Number.isInteger(e))throw new Error(`Capacity must be a positive integer. Got "${e}".`);if(!s(t))throw new Error(`"${t}" is not allowed`);r.set(this,{navigationUpperBound:p,navigationIndex:p,pointer:f,capacity:e,dataType:t,buffer:new Array(e)})}a(i,"CircularHistory");i.prototype.commit=function(e){var t=r.get(this),n=t.dataType;if(!l(e,n))throw new Error(`Type of ${e} is invalid. Expected "${n}", got "${e===null?"null":typeof e}".`);var o=t.capacity;t.pointer===t.capacity-1?(t.navigationUpperBound=o-1,t.navigationIndex=o-1):t.navigationIndex=++t.navigationUpperBound,t.buffer[u(++t.pointer,o)]=e};i.prototype.current=function(){var e=r.get(this),t=e.buffer,n=e.pointer;if(n===f)return v.empty;var o=t[u(n,e.capacity)];return d(o)?v.empty:o};i.prototype.moveBackward=function(){var e=r.get(this);e.navigationIndex===p||e.pointer===f||(e.pointer--,e.navigationIndex--)};i.prototype.moveForward=function(){var e=r.get(this);e.navigationIndex!==e.navigationUpperBound&&(e.pointer++,e.navigationIndex++)};i.prototype.clear=function(){var e=r.get(this);e.navigationIndex=p,e.navigationUpperBound=p,e.pointer=f,e.buffer=new Array(e.capacity)};i.prototype.dump=function(e=!1){var t=r.get(this),n=[...t.buffer];return e?n.filter(o=>!d(o)):n};i.prototype.getCurrentIndex=function(){var e=r.get(this);return u(e.pointer,e.capacity)};i.prototype.isStartReached=function(){var e=r.get(this);return e.navigationIndex===p};i.prototype.isEndReached=function(){var e=r.get(this);return e.navigationIndex===e.navigationUpperBound};i.FLAGS=v;export{i as CircularHistory};
